ğ—˜ğ˜…ğ—²ğ—°ğ˜‚ğ˜ğ—¶ğ˜ƒğ—² ğ—¦ğ˜‚ğ—ºğ—ºğ—®ğ—¿ğ˜† â€” GraphLib SharePoint Access

ğ—§ğ—Ÿ;ğ——ğ—¥
GraphLib does not require tenant-wide SharePoint permissions. My initial assumption that Sites.ReadWrite.All was needed was incorrect. Further testing showed that the real blocker was a tenant mismatch (fdicdev vs fdicgov), not insufficient permissions.
Correct approach: authenticate the application in the fdicgov tenant and use Sites.Selected with explicit site-level access. This resolves the issue while meeting least-privilege expectations.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğ—ªğ—µğ—®ğ˜ ğ—°ğ—µğ—®ğ—»ğ—´ğ—²ğ—±
During early troubleshooting, I requested Sites.ReadWrite.All under the assumption that broader permissions were required to resolve access errors. After deeper testing with Microsoft Graph:

I confirmed that Sites.ReadWrite.All does not resolve cross-tenant access issues.

The errors were caused by the application token being issued for the fdicdev Entra tenant, while the target SharePoint site and document library reside in fdicgov.

Microsoft Graph permissions cannot cross tenant boundaries, regardless of scope.

This clarified that the permission request was broader than necessary and not addressing the root cause.

ğ—ªğ—µğ—®ğ˜ ğ˜ğ—µğ—² ğ—¿ğ—¼ğ—¼ğ˜ ğ—°ğ—®ğ˜‚ğ˜€ğ—² ğ—¶ğ˜€

Graph site discovery consistently returned sites under fdicdev.sharepoint.com.

The intended SharePoint site and â€œGraphLibâ€ document library exist under fdicgov.sharepoint.com.

This indicates the application is authenticating to the wrong Entra tenant.

Increasing permissions (including Sites.ReadWrite.All) does not fix this condition.

ğ—–ğ—¼ğ—¿ğ—¿ğ—²ğ—°ğ˜ ğ—®ğ—°ğ—°ğ—²ğ˜€ğ˜€ ğ—ºğ—¼ğ—±ğ—²ğ—¹ (ğ—¿ğ—²ğ—°ğ—¼ğ—ºğ—ºğ—²ğ—»ğ—±ğ—²ğ—±)

Register or consent the GraphLib application in the fdicgov Entra tenant.

Use ğ—¦ğ—¶ğ˜ğ—²ğ˜€.ğ—¦ğ—²ğ—¹ğ—²ğ—°ğ˜ğ—²ğ—± (Application permission).

Grant the app explicit access to only the required SharePoint site (Read or Write).

Operate using the SharePoint Site ID and Document Library (Drive) ID.

ğ—ªğ—µğ˜† ğ˜ğ—µğ—¶ğ˜€ ğ—¶ğ˜€ ğ˜ğ—µğ—² ğ—¿ğ—¶ğ—´ğ—µğ˜ ğ—¼ğ˜‚ğ˜ğ—°ğ—¼ğ—ºğ—²

ğ—Ÿğ—²ğ—®ğ˜€ğ˜ ğ—£ğ—¿ğ—¶ğ˜ƒğ—¶ğ—¹ğ—²ğ—´ğ—²: no tenant-wide SharePoint access.

ğ—Ÿğ—¼ğ˜„ğ—²ğ—¿ ğ—¥ğ—¶ğ˜€ğ—¸: access limited to a single approved site.

ğ—”ğ˜‚ğ—±ğ—¶ğ˜-ğ—™ğ—¿ğ—¶ğ—²ğ—»ğ—±ğ—¹ğ˜†: aligns with POA&M and security review expectations.

ğ—¢ğ—½ğ—²ğ—¿ğ—®ğ˜ğ—¶ğ—¼ğ—»ğ—®ğ—¹ğ—¹ğ˜† ğ—¦ğ—¼ğ˜‚ğ—»ğ—±: avoids hostname and environment ambiguity.

ğ—¥ğ—²ğ˜€ğ˜‚ğ—¹ğ˜
Once GraphLib authenticates against the fdicgov tenant and uses Sites.Selected with site-level approval, it can function as intended without tenant-wide permissions. This resolves the access issue and corrects the initial over-permissioning assumption.